/* Write your T-SQL query statement below */

select request_at AS Day,
CAST(SUM(
    CASE WHEN Status != 'Completed' THEN 1.0 ELSE 0.0 END) / Count(Status) AS Decimal(10,2)) As 'Cancellation Rate'
FROM Trips
where request_at between '2013-10-01' and '2013-10-03'
AND client_id NOT in (SELECT users_id from Users where banned='Yes')
AND  driver_id NOT in (SELECT users_id from Users where banned='Yes')
group by Request_at

